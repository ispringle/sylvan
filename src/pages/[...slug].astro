---
import Base from "@layouts/Base.astro";
import slugify from "@utils/slugify";

export async function getStaticPaths() {
  const devMode = import.meta.env.DEV;
  const allPages = await Astro.glob("/content/*.md");

  const pages = devMode
    ? allPages
        .sort((a, b) => b.frontmatter.created.valueOf() - a.frontmatter.created.valueOf())
        .filter((a) => a.frontmatter.title != "index")
    : allPages
        .sort((a, b) => b.frontmatter.created.valueOf() - a.frontmatter.created.valueOf())
        .filter((a) => (a.frontmatter.draft = !true))
        .filter((a) => (a.frontmatter.public = !false))
        .filter((a) => a.frontmatter.title != "index");
  return pages.map((page) => {
    return {
      params: { slug: slugify(page.frontmatter.title) },
      props: { page: page },
    };
  });
}

const { page } = Astro.props;
const { Content } = page;
---

<Base pageTitle={page.frontmatter.title}>
  <Content />
</Base>
